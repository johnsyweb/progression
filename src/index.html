<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="theme-color"
      content="#fafafa"
      media="(prefers-color-scheme: light)"
    />
    <meta
      name="theme-color"
      content="#121212"
      media="(prefers-color-scheme: dark)"
    />
    <title>Progress | johnsy.com</title>
    <link rel="stylesheet" href="style.css" />
    <meta property="og:title" content="Progress | johnsy.com" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="" />
    <meta property="og:image" content="" />
    <meta property="og:image:type" content="image/svg+xml" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="" />
    <script>
      (function () {
        const path = window.location.pathname;
        const baseUrl = window.location.origin;
        const baseTag = document.querySelector("base");
        let basePath = "/";
        if (baseTag && baseTag.href) {
          try {
            const baseUrlObj = new URL(baseTag.href);
            basePath = baseUrlObj.pathname.endsWith("/")
              ? baseUrlObj.pathname.slice(0, -1)
              : baseUrlObj.pathname;
          } catch {
            basePath = "/";
          }
        }
        const ogUrl = baseUrl + (path === "/" ? "" : path);

        // Try to use dynamic SVG via service worker, fallback to static image
        const ogImagePath =
          basePath === "/" ? "/og-image.svg" : `${basePath}/og-image.svg`;
        const fallbackImagePath =
          basePath === "/"
            ? "/og-image-fallback.svg"
            : `${basePath}/og-image-fallback.svg`;
        const ogImageUrl =
          path && path !== "/" && path !== basePath
            ? baseUrl + ogImagePath + "?path=" + encodeURIComponent(path)
            : baseUrl + fallbackImagePath;

        const ogImageMeta = document.querySelector('meta[property="og:image"]');
        if (ogImageMeta) {
          ogImageMeta.setAttribute("content", ogImageUrl);
        }

        const ogUrlMeta = document.querySelector('meta[property="og:url"]');
        if (ogUrlMeta) {
          ogUrlMeta.setAttribute("content", ogUrl);
        }

        const twitterImageMeta = document.querySelector(
          'meta[name="twitter:image"]'
        );
        if (twitterImageMeta) {
          twitterImageMeta.setAttribute("content", ogImageUrl);
        }

        // Title will be updated by main.ts based on the path
      })();
    </script>
  </head>
  <body>
    <div id="page">
      <header id="header">
        <h1><a href="https://johnsy.com/">johnsy.com</a></h1>
      </header>

      <main id="content" role="main">
        <div id="progress-container"></div>
      </main>

      <div id="accesskeys" class="accesskeys">
        <p class="accesskeys-title">Keyboard shortcuts:</p>
        <ul class="accesskeys-list" id="accesskeys-list">
          <li>
            <kbd id="accesskey-title"
              ><span class="modifier-key">Alt</span>+T</kbd
            >
            Edit title
          </li>
          <li>
            <kbd id="accesskey-start"
              ><span class="modifier-key">Alt</span>+S</kbd
            >
            Edit start date
          </li>
          <li>
            <kbd id="accesskey-end"
              ><span class="modifier-key">Alt</span>+E</kbd
            >
            Edit end date
          </li>
          <li>
            <kbd id="accesskey-share"
              ><span class="modifier-key">Alt</span>+H</kbd
            >
            Share progress
          </li>
        </ul>
      </div>

      <footer id="footer">
        <p>
          Copyright &copy; 2000-<span id="current-year"></span>
          <a rel="author" href="https://johnsy.com/about/"
            ><em><acronym title="Peter Alexander Johns">paj</acronym></em></a
          >
          (<a
            rel="me"
            aria-label="@pete.johnsy.com on Bluesky"
            href="https://bsky.app/profile/pete.johnsy.com"
            >@pete.johnsy.com</a
          >) All rights (and some wrongs) reserved.
        </p>
      </footer>
    </div>

    <script type="module" src="/main.ts"></script>
    <script>
      document.getElementById("current-year").textContent =
        new Date().getFullYear();
    </script>
  </body>
</html>
